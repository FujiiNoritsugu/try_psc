from google.cloud import aiplatform_v1
import grpc

# Set variables for the current deployed index.
INDEX_ENDPOINT = "projects/1010478563120/locations/asia-northeast1/indexEndpoints/6958430860194349056"
DEPLOYED_INDEX_ID = "deploy_20250517_1747425470169"

# Configure Vector Search client
channel = grpc.insecure_channel(target="10.0.0.5:10000")
transport = (
    aiplatform_v1.services.match_service.transports.grpc.MatchServiceGrpcTransport(
        channel=channel
    )
)
vector_search_client = aiplatform_v1.MatchServiceClient(transport=transport)

feature_vector = [
    0.024530868977308273,
    -0.040793128311634064,
    0.00047576811630278826,
    0.017147192731499672,
    0.026629658415913582,
    -0.06141049787402153,
    0.020689481869339943,
    0.032609399408102036,
    -0.043242260813713074,
    -0.0030736858025193214,
    0.029859514907002449,
    -0.0070092626847326756,
    0.0074279718101024628,
    0.0044401995837688446,
    0.012789646163582802,
    0.0056940736249089241,
    -0.050746820867061615,
    -0.016834203153848648,
    -0.0025733353104442358,
    0.030782531946897507,
    -0.028840042650699615,
    0.013945236802101135,
    -0.0078231878578662872,
    -0.073326528072357178,
    -0.028099022805690765,
    -0.091063208878040314,
    0.016907420009374619,
    -0.0062174019403755665,
    0.0086391577497124672,
    -0.021324845030903816,
    -0.030394084751605988,
    -0.042661987245082855,
    -0.021932870149612427,
    -0.024862896651029587,
    0.025864196941256523,
    0.0095110638067126274,
    -0.023645631968975067,
    0.018030215054750443,
    0.013453914783895016,
    0.014843377284705639,
    -0.021920621395111084,
    0.0013795378617942333,
    -0.008049551397562027,
    -0.0019481810741126537,
    -0.064538702368736267,
    -0.0091690300032496452,
    -0.031745024025440216,
    0.013160046190023422,
    -0.0055812862701714039,
    -0.051511391997337341,
    -0.034813474863767624,
    -0.04427681490778923,
    -0.048338469117879868,
    -0.0033706477843225002,
    0.079504400491714478,
    0.028930405154824257,
    -0.012288942933082581,
    0.020540427416563034,
    0.00997206661850214,
    -0.0080815190449357033,
    0.034826241433620453,
    -0.055772155523300171,
    0.039791896939277649,
    -0.047629151493310928,
    -0.023049546405673027,
    -0.0054811146110296249,
    -0.005749962292611599,
    -0.0066005219705402851,
    -0.00073689589044079185,
    0.022543923929333687,
    0.047829858958721161,
    -0.023717924952507019,
    -0.018625242635607719,
    -0.040944643318653107,
    0.017400316894054413,
    0.0079149780794978142,
    0.022023264318704605,
    -0.014264348894357681,
    0.035185720771551132,
    -0.055737756192684174,
    0.026307474821805954,
    -0.032621525228023529,
    -0.082146905362606049,
    -0.070890501141548157,
    0.038797758519649506,
    0.032813116908073425,
    -0.033462010324001312,
    -0.0086335595697164536,
    -0.032480265945196152,
    0.030566729605197906,
    -0.020948478952050209,
    -0.015153571031987667,
    0.0055873645469546318,
    0.042684290558099747,
    -0.028214503079652786,
    -0.0066657313145697117,
    -0.0673646554350853,
    -0.029120024293661118,
    0.024024475365877151,
    0.018188707530498505,
    -0.0077900951728224754,
    -0.016652395948767662,
    0.034902341663837433,
    -0.029990250244736671,
    0.043491218239068985,
    0.021248660981655121,
    -0.016215050593018532,
    0.021905161440372467,
    -0.074088491499423981,
    -0.11639219522476196,
    -0.042051419615745544,
    0.0367405004799366,
    -0.020716719329357147,
    0.0384451188147068,
    0.030385289341211319,
    -0.029232332482933998,
    0.019791105762124062,
    -0.00030203119968064129,
    0.0070682461373507977,
    0.024266423657536507,
    -0.057139445096254349,
    0.0168314129114151,
    -0.0048368452116847038,
    -0.046005282551050186,
    -0.040220458060503006,
    -0.0050777359865605831,
    0.038663424551486969,
    0.015641171485185623,
    0.0683717206120491,
    0.013727492652833462,
    0.023580741137266159,
    0.025800002738833427,
    0.037390757352113724,
    0.014215994626283646,
    -0.0098280347883701324,
    0.052923381328582764,
    0.042442556470632553,
    0.049353830516338348,
    -0.0025617741048336029,
    0.015969227999448776,
    -0.101860910654068,
    -0.036268759518861771,
    -0.011959224939346313,
    0.019897006452083588,
    -0.018964005634188652,
    -0.040887046605348587,
    0.001492866431362927,
    -0.060353521257638931,
    -0.05112650990486145,
    -0.0881601944565773,
    -0.00463015167042613,
    -0.024605618789792061,
    -0.046009920537471771,
    0.015227816998958588,
    0.083471767604351044,
    0.055114075541496277,
    0.033028915524482727,
    0.013892750255763531,
    0.001736784353852272,
    -0.05809393897652626,
    0.013220138847827911,
    -0.013688343577086926,
    0.0035501495003700256,
    -0.03018607571721077,
    0.020214105024933815,
    -0.028247423470020294,
    -0.00094096100656315684,
    -0.01085735484957695,
    0.011357137002050877,
    0.0599856860935688,
    0.036547057330608368,
    -0.093496792018413544,
    0.032329384237527847,
    -0.048025995492935181,
    0.061915889382362366,
    -0.012601272203028202,
    -0.025568140670657158,
    0.054340261965990067,
    0.026335526257753372,
    -0.040273338556289673,
    0.0081177419051527977,
    -0.081776164472103119,
    -0.022858073934912682,
    -0.019231811165809631,
    -0.044647332280874252,
    0.023686863481998444,
    -0.013458254747092724,
    -0.048708859831094742,
    -0.040526483207941055,
    0.0427907332777977,
    -0.029311817139387131,
    -0.00060664262855425477,
    -0.024849167093634605,
    -0.013840390369296074,
    0.0016717442777007818,
    0.0029921471141278744,
    0.086855843663215637,
    -0.15017712116241455,
    0.042410075664520264,
    -0.00096216646488755941,
    -0.021243836730718613,
    -0.037187658250331879,
    0.017442051321268082,
    0.060480199754238129,
    -0.0340849943459034,
    0.0083872079849243164,
    -0.089482516050338745,
    -0.016106300055980682,
    0.050941396504640579,
    -0.0071017369627952576,
    0.0051371632143855095,
    -0.00059280527057126164,
    0.0255195964127779,
    0.050932124257087708,
    0.012188906781375408,
    -0.027066946029663086,
    0.032557718455791473,
    -0.035164892673492432,
    -0.039837438613176346,
    -0.030488524585962296,
    -0.0087310364469885826,
    -0.012678212486207485,
    0.031777843832969666,
    0.020815044641494751,
    0.029746934771537781,
    0.022280303761363029,
    0.037840209901332855,
    0.025743849575519562,
    0.026360472664237022,
    -0.036996711045503616,
    -0.081752389669418335,
    0.01092135813087225,
    -0.020514894276857376,
    0.00086982554057613015,
    -0.0044689071364700794,
    0.10205782949924469,
    0.0081904381513595581,
    -0.012558556161820889,
    -0.046808276325464249,
    -0.062899507582187653,
    0.014013092964887619,
    0.010236272588372231,
    0.0019369350047782063,
    0.028365448117256165,
    -0.0098693743348121643,
    0.0085351327434182167,
    0.011848408728837967,
    -0.03328343853354454,
    0.032414626330137253,
    -0.002546247560530901,
    0.021724136546254158,
    -0.061822704970836639,
    0.0077056447044014931,
    0.012254620902240276,
    0.042465507984161377,
    -0.040529187768697739,
    -0.022896373644471169,
    -0.025746079161763191,
    -0.017228852957487106,
    0.040431465953588486,
    0.013976014219224453,
    0.0437922477722168,
    0.07898414134979248,
    0.043006081134080887,
    0.0072787981480360031,
    -0.025895891711115837,
    -0.077255196869373322,
    0.0258529931306839,
    0.046779647469520569,
    -0.02917136624455452,
    -0.01706538163125515,
    -0.017445309087634087,
    0.01351596973836422,
    0.038696859031915665,
    0.010281023569405079,
    0.013027392327785492,
    -0.012262918055057526,
    0.022460132837295532,
    0.026825720444321632,
    0.041943907737731934,
    -0.018718795850872993,
    -0.056643377989530563,
    0.01940213143825531,
    0.068839304149150848,
    0.022097771987318993,
    0.016552450135350227,
    -0.00648548873141408,
    0.003333068685606122,
    -0.052719518542289734,
    0.023046521469950676,
    -0.037765804678201675,
    -0.0098085273057222366,
    0.022490175440907478,
    0.054706644266843796,
    0.012999014928936958,
    0.01050169114023447,
    0.046432863920927048,
    -0.0051089953631162643,
    -0.020698351785540581,
    0.01646910049021244,
    -0.012810796499252319,
    -0.030057825148105621,
    0.026339370757341385,
    -0.023207912221550941,
    -0.0049620983190834522,
    0.0046620629727840424,
    -0.020838906988501549,
    0.04242919385433197,
    0.060251671820878983,
    -0.0068205134011805058,
    -0.0058946376666426659,
    0.0089258253574371338,
    -0.010317021049559116,
    0.012509041465818882,
    0.0071431095711886883,
    0.00091642694314941764,
    -0.035153798758983612,
    -0.044869091361761093,
    -0.07570830732584,
    0.0067550013773143291,
    -0.080084823071956635,
    0.011622893624007702,
    -0.0030948847997933626,
    0.066032819449901581,
    -0.018081037327647209,
    -0.028912974521517754,
    0.014701901935040951,
    -0.0081273121759295464,
    0.026916865259408951,
    -0.095327816903591156,
    0.019338550046086311,
    -0.044491913169622421,
    -0.042977370321750641,
    0.052459064871072769,
    0.010374348610639572,
    0.052758090198040009,
    0.015130159445106983,
    -0.035151567310094833,
    -0.034894850105047226,
    -0.08543037623167038,
    -0.015835845842957497,
    -0.022810108959674835,
    -0.058205481618642807,
    -0.029196469113230705,
    0.01000114344060421,
    -0.0051575507968664169,
    -0.032990012317895889,
    0.026253968477249146,
    -0.044343072921037674,
    -0.045864541083574295,
    0.02350398525595665,
    -0.048464350402355194,
    0.013036467134952545,
    0.017190443351864815,
    0.010492798872292042,
    -0.020729454234242439,
    0.028755893930792809,
    -0.02103029191493988,
    0.0323096327483654,
    -0.0094727268442511559,
    -0.006868001539260149,
    -0.00098024099133908749,
    -0.049573339521884918,
    -0.00050371617544442415,
    0.017338810488581657,
    0.0017882171086966991,
    -0.059696484357118607,
    -0.0007223699358291924,
    0.018547503277659416,
    -0.012126125395298004,
    -0.025882665067911148,
    -0.018086383119225502,
    0.03131011500954628,
    0.015382379293441772,
    -0.034425705671310425,
    -0.00972181186079979,
    -0.028299441561102867,
    0.042993098497390747,
    0.0059609725140035152,
    0.028224729001522064,
    -0.0479520820081234,
    0.056300796568393707,
    -0.014015494845807552,
    0.0090788975358009338,
    -0.0069310409016907215,
    0.0098787695169448853,
    0.058729704469442368,
    0.036074895411729813,
    0.020683508366346359,
    -0.039776977151632309,
    0.0027620373293757439,
    -0.0023796888999640942,
    -0.021372321993112564,
    -0.040584318339824677,
    -0.026224376633763313,
    -0.0091802291572093964,
    -0.053224902600049973,
    0.0362909771502018,
    0.0042943353764712811,
    -9.4159113359637558e-05,
    0.026834676042199135,
    0.052755333483219147,
    -0.076995566487312317,
    -0.079402536153793335,
    -0.011251632124185562,
    0.0099690677598118782,
    -0.0056884195655584335,
    0.045417487621307373,
    -0.00016882576164789498,
    0.0083759138360619545,
    0.0633992850780487,
    -0.026509376242756844,
    0.011014851741492748,
    -0.0056952266022562981,
    0.0085989115759730339,
    -0.060178309679031372,
    0.020492220297455788,
    -0.054264675825834274,
    0.00038548436714336276,
    0.02410341240465641,
    0.053730648010969162,
    0.010843616910278797,
    0.027590839192271233,
    0.010408050380647182,
    -0.0072660255245864391,
    0.011779793538153172,
    -0.095939919352531433,
    -0.0095131741836667061,
    0.0086357202380895615,
    -0.03865109384059906,
    -0.028358148410916328,
    -0.015010683797299862,
    0.019045416265726089,
    -0.0059228339232504368,
    -0.0755491703748703,
    -0.07522428035736084,
    0.021174089983105659,
    0.075554393231868744,
    0.0039555062539875507,
    -0.044804327189922333,
    -0.025703350082039833,
    0.047739464789628983,
    -0.061268988996744156,
    0.02589661069214344,
    -0.032175600528717041,
    -0.032020732760429382,
    0.029802730306982994,
    -0.044982589781284332,
    -0.053544975817203522,
    -0.0068680834956467152,
    -0.012180367484688759,
    -0.00892695039510727,
    0.039017029106616974,
    0.068760126829147339,
    0.0025496280286461115,
    0.033272452652454376,
    0.022672070190310478,
    -0.065565101802349091,
    -0.021974166855216026,
    -0.0026608987245708704,
    -0.053039707243442535,
    0.014983180910348892,
    0.03173525258898735,
    0.02701961062848568,
    -0.0015418867114931345,
    -0.037783630192279816,
    0.036301705986261368,
    0.012505990453064442,
    -0.014652537181973457,
    0.041675016283988953,
    -0.0021603109780699015,
    0.029955280944705009,
    -0.040177710354328156,
    -0.0046530072577297688,
    0.075951263308525085,
    0.0075053866021335125,
    0.024015633389353752,
    0.024155713617801666,
    -0.062767975032329559,
    -0.0095573924481868744,
    -0.033488374203443527,
    -0.014038443565368652,
    -0.035294763743877411,
    -0.04610036313533783,
    0.047670736908912659,
    0.039906442165374756,
    0.022212887182831764,
    -0.055783841758966446,
    0.025279786437749863,
    0.048422638326883316,
    0.024685200303792953,
    -0.0048854672349989414,
    -0.0017897707875818014,
    -0.0049101244658231735,
    0.055619116872549057,
    0.0086486022919416428,
    -0.0093186311423778534,
    0.0313420370221138,
    0.034851390868425369,
    -0.037986431270837784,
    0.0380852036178112,
    0.01675182580947876,
    0.0085314372554421425,
    0.00079775264021009207,
    -0.012675176374614239,
    -0.00086200342047959566,
    -0.0093289222568273544,
    -0.00020428876450750977,
    -0.019296634942293167,
    0.015750076621770859,
    -0.033807825297117233,
    -0.011686782352626324,
    0.0076404246501624584,
    0.00513467937707901,
    -0.05752824991941452,
    -0.082032598555088043,
    0.0014584626769647002,
    0.062373872846364975,
    -0.012656869366765022,
    -0.0087263118475675583,
    0.0094135534018278122,
    -0.00235772505402565,
    0.0060889157466590405,
    0.044313922524452209,
    0.053418960422277451,
    0.0752813071012497,
    0.0056178034283220768,
    -0.055326662957668304,
    -0.067632183432579041,
    0.04343361034989357,
    0.0450504906475544,
    0.034624889492988586,
    0.006949275266379118,
    0.009428560733795166,
    0.0038527150172740221,
    -0.020887900143861771,
    0.04308762401342392,
    0.023858075961470604,
    0.026946313679218292,
    0.0366373173892498,
    -0.0010360800661146641,
    -0.034203715622425079,
    0.039870575070381165,
    0.022269668057560921,
    0.07165372371673584,
    0.087397955358028412,
    0.024625999853014946,
    0.066822081804275513,
    0.020196530967950821,
    0.040220573544502258,
    -0.032292064279317856,
    -0.094758890569210052,
    -0.022695261985063553,
    0.052570033818483353,
    0.03306690976023674,
    -0.035054821521043777,
    -0.030653057619929314,
    -0.088685572147369385,
    -0.040578827261924744,
    -0.014793972484767437,
    -0.0037265564315021038,
    -0.019342636689543724,
    -0.002964129438623786,
    -0.044648390263319016,
    0.02201150543987751,
    -0.096598044037818909,
    0.015702718868851662,
    0.046250373125076294,
    0.0045402683317661285,
    0.05517943948507309,
    0.061812013387680054,
    -0.075800046324729919,
    -0.012971668504178524,
    0.02003030851483345,
    0.01085840817540884,
    0.064194120466709137,
    -0.014240780845284462,
    0.0499708466231823,
    -0.021620728075504303,
    0.0035016038455069065,
    -0.0063117174431681633,
    0.031899116933345795,
    -0.0021724032703787088,
    -0.02025260217487812,
    -0.0058270096778869629,
    -0.029683034867048264,
    -0.0025771358050405979,
    -0.023432796820998192,
    0.00022744883608538657,
    -0.040489841252565384,
    0.011506937444210052,
    -0.089830763638019562,
    0.048826891928911209,
    0.025631900876760483,
    -0.033584382385015488,
    -0.025766313076019287,
    0.0094252424314618111,
    0.027470052242279053,
    0.029060592874884605,
    0.031851079314947128,
    0.0020505210850387812,
    -0.011135139502584934,
    0.032594680786132812,
    -0.058864351361989975,
    0.029071895405650139,
    -0.033763375133275986,
    0.042984042316675186,
    -0.0077073248103260994,
    0.043975874781608582,
    -0.027872195467352867,
    0.0036887556780129671,
    0.0051250397227704525,
    0.038081221282482147,
    0.0012628415133804083,
    -0.073064297437667847,
    0.014817895367741585,
    -0.03112482838332653,
    0.04555259644985199,
    0.032038144767284393,
    0.0241865087300539,
    0.063715547323226929,
    -0.044297970831394196,
    0.0019881881307810545,
    0.0020013288594782352,
    0.024878555908799171,
    0.070742480456829071,
    0.005450777243822813,
    -0.0021110326051712036,
    -0.048206605017185211,
    -0.045401040464639664,
    -0.007294192910194397,
    -0.014740629121661186,
    -0.041368246078491211,
    -0.028626134619116783,
    0.0064073037356138229,
    -0.024207292124629021,
    -0.049498043954372406,
    0.00052568822866305709,
    0.01754385232925415,
    0.017700724303722382,
    0.013580745086073875,
    -0.0039957370609045029,
    -0.027335699647665024,
    -0.010050814598798752,
    -0.021305518224835396,
    -0.010202860459685326,
    -0.010496604256331921,
    0.015593424439430237,
    0.0043306457810103893,
    -0.029841771349310875,
    -0.0096399849280714989,
    -0.028663258999586105,
    0.00084871315630152822,
    -0.099095933139324188,
    -0.048373814672231674,
    0.020565498620271683,
    -0.016124933958053589,
    -0.00777638703584671,
    -0.039693821221590042,
    0.047247294336557388,
    -0.008205953985452652,
    -0.015027991496026516,
    0.048506081104278564,
    -0.012502356432378292,
    -0.044449977576732635,
    0.04849914088845253,
    0.02711067907512188,
    0.0062796720303595066,
    -0.021222503855824471,
    0.014854498207569122,
    -0.030289025977253914,
    -0.02342613972723484,
    0.00743856281042099,
    -0.038202796131372452,
    0.020487837493419647,
    -0.017059536650776863,
    0.029456622898578644,
    0.068667292594909668,
    -0.0046340418048202991,
    -0.0060735424049198627,
    -0.023102132603526115,
    0.017920823767781258,
    0.022385913878679276,
    -0.0066987690515816212,
    -0.023259777575731277,
    -0.0029578045941889286,
    -0.00933670625090599,
    0.061357934027910233,
    0.051680654287338257,
    -0.0045741735957562923,
    0.015281303785741329,
    0.015126295387744904,
    -0.0056199105456471443,
    -0.0088018141686916351,
    0.030623922124505043,
    -0.0076204510405659676,
    -0.022442879155278206,
    0.042155511677265167,
    -0.00267305807210505,
    -0.00714292423799634,
    -0.075346887111663818,
    0.0075820442289114,
    -0.037335172295570374,
    -0.0067555094137787819,
    0.0704963207244873,
    0.017988003790378571,
    -0.047304078936576843,
    -0.011715016327798367,
    -0.062190301716327667,
    -0.029741743579506874,
    -0.0052689523436129093,
    -0.0062427138909697533,
    0.053515292704105377,
    -0.0024256317410618067,
    -0.022741097956895828,
    0.037524297833442688,
    -0.076188132166862488,
    0.015404161997139454,
    0.038748946040868759,
    0.0027085556648671627,
    0.030968017876148224,
    -0.017451690509915352,
    0.027111435309052467,
    -0.03577268123626709,
    -0.018581055104732513,
    0.010632872581481934,
    0.01042613573372364,
    -0.011205912567675114,
    0.0071428087539970875,
    0.076384112238883972,
    -0.040410228073596954,
    0.010098931379616261,
    0.048534676432609558,
    0.046572189778089523,
    0.020653275772929192,
    -0.0090518677607178688,
    0.060298755764961243,
    -0.057761345058679581,
    0.0550248958170414,
    -0.077249892055988312,
    -0.010213135741651058,
    0.0323222316801548,
    0.0060217268764972687,
    -0.01935386098921299,
    0.060236379504203796,
    0.029063152149319649,
    0.054347038269042969,
    -0.0079098166897892952,
    -0.040403660386800766,
    -0.011306465603411198,
    -0.028101198375225067,
    -0.012190732173621655,
    -0.0017571168718859553,
    0.032280255109071732,
    -0.024971120059490204,
    0.033544700592756271,
    0.054850861430168152,
    0.042531691491603851,
    -0.027751056477427483,
    0.041389394551515579,
    -0.024782465770840645,
    0.019581679254770279,
    -0.011114966124296188,
    -0.022669149562716484,
    0.027811909094452858,
    -0.010918718762695789,
    -0.025218777358531952,
    -0.029402086511254311,
]
# Build FindNeighborsRequest object
datapoint = aiplatform_v1.IndexDatapoint(feature_vector=feature_vector)

query = aiplatform_v1.FindNeighborsRequest.Query(
    datapoint=datapoint,
    # The number of nearest neighbors to be retrieved
    neighbor_count=10,
)
request = aiplatform_v1.FindNeighborsRequest(
    index_endpoint=INDEX_ENDPOINT,
    deployed_index_id=DEPLOYED_INDEX_ID,
    # Request can have multiple queries
    queries=[query],
    return_full_datapoint=False,
)

# Execute the request
response = vector_search_client.find_neighbors(request)

# Handle the response
print(response)
